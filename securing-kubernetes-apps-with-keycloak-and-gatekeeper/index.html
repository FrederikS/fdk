<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.f628065b851287e306e5.css">@font-face{font-family:IBM Plex Sans;font-style:normal;font-display:swap;font-weight:100;src:local("IBM Plex Sans Thin "),local("IBM Plex Sans-Thin"),url(/static/ibm-plex-sans-latin-100-245539db8ee56425757ef728eda8194e.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-100-9a582f3a304f421eca4027517706843c.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:italic;font-display:swap;font-weight:100;src:local("IBM Plex Sans Thin italic"),local("IBM Plex Sans-Thinitalic"),url(/static/ibm-plex-sans-latin-100italic-3c34cf080b38f5fb1d4c59ffa45b3967.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-100italic-1ea7c5d21b5956b602bdf9656cfb353f.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:normal;font-display:swap;font-weight:200;src:local("IBM Plex Sans Extra Light "),local("IBM Plex Sans-Extra Light"),url(/static/ibm-plex-sans-latin-200-bf72c8412ab06c393f52efc5beb26ea7.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-200-67524c36348a323f78f2845e3aafc2d4.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:italic;font-display:swap;font-weight:200;src:local("IBM Plex Sans Extra Light italic"),local("IBM Plex Sans-Extra Lightitalic"),url(/static/ibm-plex-sans-latin-200italic-bbc2d55223638ce450424a917e1104b2.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-200italic-52df25607ec284ca361ae50ba24b3580.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:normal;font-display:swap;font-weight:300;src:local("IBM Plex Sans Light "),local("IBM Plex Sans-Light"),url(/static/ibm-plex-sans-latin-300-9e1c48af24191f6ea8aede14957c5d01.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-300-10bb6a0ae6dc8000d999ab622a45e281.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:italic;font-display:swap;font-weight:300;src:local("IBM Plex Sans Light italic"),local("IBM Plex Sans-Lightitalic"),url(/static/ibm-plex-sans-latin-300italic-c76f2ab53673e964b6e6734c1c455761.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-300italic-d3566d5bb4f31d86bfb9fda09563b416.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:normal;font-display:swap;font-weight:400;src:local("IBM Plex Sans Regular "),local("IBM Plex Sans-Regular"),url(/static/ibm-plex-sans-latin-400-263d6267533501f58c33b12b382e3abb.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-400-a2c56f946488a9a267ba6ba21471a217.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:italic;font-display:swap;font-weight:400;src:local("IBM Plex Sans Regular italic"),local("IBM Plex Sans-Regularitalic"),url(/static/ibm-plex-sans-latin-400italic-89a93a1bdde48c7bb104150de88affce.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-400italic-272f86114c980c52c131dfc3b4ae3276.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:normal;font-display:swap;font-weight:500;src:local("IBM Plex Sans Medium "),local("IBM Plex Sans-Medium"),url(/static/ibm-plex-sans-latin-500-0866c24487514ad726738fb24f8e015b.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-500-f6d5c5d5b849796d6a8f5a2953b60753.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:italic;font-display:swap;font-weight:500;src:local("IBM Plex Sans Medium italic"),local("IBM Plex Sans-Mediumitalic"),url(/static/ibm-plex-sans-latin-500italic-ffd12d59339823b8cf53b9f99b47d87c.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-500italic-ccd41bd1a5bfa8bad2cd8d35fdaeb3d1.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:normal;font-display:swap;font-weight:600;src:local("IBM Plex Sans SemiBold "),local("IBM Plex Sans-SemiBold"),url(/static/ibm-plex-sans-latin-600-7852d4dc26ef44df58e23dc0b9722d6f.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-600-337b16517a230dc830b84dc6e6167b68.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:italic;font-display:swap;font-weight:600;src:local("IBM Plex Sans SemiBold italic"),local("IBM Plex Sans-SemiBolditalic"),url(/static/ibm-plex-sans-latin-600italic-17e5379fd9a99b9bcb26ea983f391b6a.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-600italic-6f4ba6aa87fa99d5bc2b90a7b40a0ded.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:normal;font-display:swap;font-weight:700;src:local("IBM Plex Sans Bold "),local("IBM Plex Sans-Bold"),url(/static/ibm-plex-sans-latin-700-c9983d3d04f3ed6c2eafee1db1d24e06.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-700-b8809d619a33eb825b0450281ff752e7.woff) format("woff")}@font-face{font-family:IBM Plex Sans;font-style:italic;font-display:swap;font-weight:700;src:local("IBM Plex Sans Bold italic"),local("IBM Plex Sans-Bolditalic"),url(/static/ibm-plex-sans-latin-700italic-02954beec9e742bb1f3ae27b7e7cb71f.woff2) format("woff2"),url(/static/ibm-plex-sans-latin-700italic-72e9af409ddafc63a5dd380e34758560.woff) format("woff")}</style><meta name="generator" content="Gatsby 2.24.37"/><link rel="alternate" type="application/rss+xml" title="Minimal Blog - @lekoarts/gatsby-theme-minimal-blog" href="/rss.xml"/><title data-react-helmet="true">Securing Kubernetes Apps with Keycloak and Gatekeeper | fdk</title><link data-react-helmet="true" rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link data-react-helmet="true" rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link data-react-helmet="true" rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><meta data-react-helmet="true" name="description" content="Example of securing an application by using keycloak and the OIDC protocol along with gatekeeper. Everything running inside a Kubernetes cluster."/><meta data-react-helmet="true" name="image" content="https://fdk.codes/banner.jpg"/><meta data-react-helmet="true" property="og:title" content="Securing Kubernetes Apps with Keycloak and Gatekeeper"/><meta data-react-helmet="true" property="og:url" content="https://fdk.codes/securing-kubernetes-apps-with-keycloak-and-gatekeeper/"/><meta data-react-helmet="true" property="og:description" content="Example of securing an application by using keycloak and the OIDC protocol along with gatekeeper. Everything running inside a Kubernetes cluster."/><meta data-react-helmet="true" property="og:image" content="https://fdk.codes/banner.jpg"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:image:alt" content="Example of securing an application by using keycloak and the OIDC protocol along with gatekeeper. Everything running inside a Kubernetes cluster."/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:title" content="Securing Kubernetes Apps with Keycloak and Gatekeeper"/><meta data-react-helmet="true" name="twitter:url" content="https://fdk.codes/securing-kubernetes-apps-with-keycloak-and-gatekeeper/"/><meta data-react-helmet="true" name="twitter:description" content="Example of securing an application by using keycloak and the OIDC protocol along with gatekeeper. Everything running inside a Kubernetes cluster."/><meta data-react-helmet="true" name="twitter:image" content="https://fdk.codes/banner.jpg"/><meta data-react-helmet="true" name="twitter:image:alt" content="Example of securing an application by using keycloak and the OIDC protocol along with gatekeeper. Everything running inside a Kubernetes cluster."/><meta data-react-helmet="true" name="twitter:creator" content="@lekoarts_de"/><meta data-react-helmet="true" name="gatsby-theme" content="@lekoarts/gatsby-theme-minimal-blog"/><link rel="canonical" href="https://fdk.codes/securing-kubernetes-apps-with-keycloak-and-gatekeeper/" data-baseprotocol="https:" data-basehost="fdk.codes"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='UA-163296224-1',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(!(parseInt(navigator.doNotTrack) === 1 || parseInt(window.doNotTrack) === 1 || parseInt(navigator.msDoNotTrack) === 1 || navigator.doNotTrack === "yes")) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-163296224-1', 'auto', {"cookieExpires":0,"storage":"none"});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/favicon-32x32.png?v=2aea62e3da343187886b02a025cce44f" type="image/png"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#6B46C1"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=2aea62e3da343187886b02a025cce44f"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=2aea62e3da343187886b02a025cce44f"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=2aea62e3da343187886b02a025cce44f"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=2aea62e3da343187886b02a025cce44f"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=2aea62e3da343187886b02a025cce44f"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=2aea62e3da343187886b02a025cce44f"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=2aea62e3da343187886b02a025cce44f"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=2aea62e3da343187886b02a025cce44f"/><link as="script" rel="preload" href="/webpack-runtime-eb4bd5f9f9bc8e21e756.js"/><link as="script" rel="preload" href="/framework-0e8501c0599d79803b4b.js"/><link as="script" rel="preload" href="/app-a8c28beaf1507299f728.js"/><link as="script" rel="preload" href="/styles-c2fe8482057191dca484.js"/><link as="script" rel="preload" href="/102afc7344577b55a38080236d2030dfabdf8510-02237cb284883f3ba59b.js"/><link as="script" rel="preload" href="/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-1ed02939c4aac9155aae.js"/><link as="fetch" rel="preload" href="/page-data/securing-kubernetes-apps-with-keycloak-and-gatekeeper/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/318001574.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3787687951.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3787687951.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.body.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion-css="139sp4t">body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#6b46c1);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#5f6c80);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);--theme-ui-colors-code-bgInline:var(--theme-ui-colors-code-bgInline,#f6f8fa);--theme-ui-colors-code-bg:var(--theme-ui-colors-code-bg,#f6f8fa);--theme-ui-colors-code-text:var(--theme-ui-colors-code-text,#393A34);--theme-ui-colors-code-remove:var(--theme-ui-colors-code-remove,#d73a49);--theme-ui-colors-code-add:var(--theme-ui-colors-code-add,#36acaa);--theme-ui-colors-code-selector:var(--theme-ui-colors-code-selector,rgb(215,58,73));--theme-ui-colors-code-tag:var(--theme-ui-colors-code-tag,#00009f);--theme-ui-colors-code-keyword:var(--theme-ui-colors-code-keyword,rgb(0,0,159));--theme-ui-colors-code-comment:var(--theme-ui-colors-code-comment,#999988);--theme-ui-colors-code-punctuation:var(--theme-ui-colors-code-punctuation,#393A34);--theme-ui-colors-code-regex:var(--theme-ui-colors-code-regex,#36acaa);--theme-ui-colors-code-cssString:var(--theme-ui-colors-code-cssString,#e3116c);--theme-ui-colors-code-class:var(--theme-ui-colors-code-class,#393A34);--theme-ui-colors-code-bgLanguage:var(--theme-ui-colors-code-bgLanguage,white);--theme-ui-colors-code-textLanguage:var(--theme-ui-colors-code-textLanguage,black);--theme-ui-colors-code-border:var(--theme-ui-colors-code-border,#ececec);--theme-ui-colors-code-lineHighlightBackground:var(--theme-ui-colors-code-lineHighlightBackground,#fbf0ea);--theme-ui-colors-code-lineHighlightBorder:var(--theme-ui-colors-code-lineHighlightBorder,#f1beb6);color:var(--theme-ui-colors-text,#2d3748);background-color:var(--theme-ui-colors-background,#fff);}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#9f7aea);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);--theme-ui-colors-code-bgInline:var(--theme-ui-colors-modes-dark-code-bgInline,#1E1E1E);--theme-ui-colors-code-bg:var(--theme-ui-colors-modes-dark-code-bg,#1E1E1E);--theme-ui-colors-code-text:var(--theme-ui-colors-modes-dark-code-text,#9CDCFE);--theme-ui-colors-code-remove:var(--theme-ui-colors-modes-dark-code-remove,rgb(206,145,120));--theme-ui-colors-code-add:var(--theme-ui-colors-modes-dark-code-add,rgb(181,206,168));--theme-ui-colors-code-selector:var(--theme-ui-colors-modes-dark-code-selector,rgb(215,186,125));--theme-ui-colors-code-tag:var(--theme-ui-colors-modes-dark-code-tag,rgb(78,201,176));--theme-ui-colors-code-keyword:var(--theme-ui-colors-modes-dark-code-keyword,rgb(86,156,214));--theme-ui-colors-code-comment:var(--theme-ui-colors-modes-dark-code-comment,rgb(106,153,85));--theme-ui-colors-code-punctuation:var(--theme-ui-colors-modes-dark-code-punctuation,rgb(212,212,212));--theme-ui-colors-code-regex:var(--theme-ui-colors-modes-dark-code-regex,rgb(181,206,168));--theme-ui-colors-code-cssString:var(--theme-ui-colors-modes-dark-code-cssString,rgb(206,145,120));--theme-ui-colors-code-class:var(--theme-ui-colors-modes-dark-code-class,rgb(78,201,176));--theme-ui-colors-code-bgLanguage:var(--theme-ui-colors-modes-dark-code-bgLanguage,black);--theme-ui-colors-code-textLanguage:var(--theme-ui-colors-modes-dark-code-textLanguage,white);--theme-ui-colors-code-border:var(--theme-ui-colors-modes-dark-code-border,#2c2c2c);--theme-ui-colors-code-lineHighlightBackground:var(--theme-ui-colors-modes-dark-code-lineHighlightBackground,rgba(54,32,102,0.25));--theme-ui-colors-code-lineHighlightBorder:var(--theme-ui-colors-modes-dark-code-lineHighlightBorder,#362066);}</style><style data-emotion-css="1t0v9q4">*{box-sizing:border-box;}body{margin:0;font-family:"IBM Plex Sans",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.7;font-weight:400;color:var(--theme-ui-colors-text,#2d3748);background-color:var(--theme-ui-colors-background,#fff);padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion-css="12qonc8">.css-12qonc8{font-family:"IBM Plex Sans",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.7;font-weight:400;color:var(--theme-ui-colors-text,#2d3748);background-color:var(--theme-ui-colors-background,#fff);margin:0;padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}</style><div data-testid="theme-root" class="css-12qonc8"><style data-emotion-css="1bmble2">.token{display:inline-block;}.token.comment,.token.block-comment,.token.prolog,.token.doctype,.token.cdata{color:var(--theme-ui-colors-code-comment,#999988);}.token.property,.token.tag,.token.boolean,.token.number,.token.function-name,.token.constant,.token.symbol{color:var(--theme-ui-colors-code-tag,#00009f);}.token.punctuation{color:var(--theme-ui-colors-code-punctuation,#393A34);}.token.selector,.token.attr-name,.token.string,.token.char,.token.function,.token.builtin{color:var(--theme-ui-colors-code-selector,rgb(215,58,73));}.token.operator,.token.entity,.token.url,.token.variable{color:var(--theme-ui-colors-code-add,#36acaa);}.token.atrule,.token.attr-value,.token.keyword{color:var(--theme-ui-colors-code-keyword,rgb(0,0,159));}.token.inserted{color:var(--theme-ui-colors-code-add,#36acaa);}.token.deleted{color:var(--theme-ui-colors-code-remove,#d73a49);}.token.regex,.token.important{color:var(--theme-ui-colors-code-regex,#36acaa);}.token.class-name{color:var(--theme-ui-colors-code-class,#393A34);}.language-css .token.string,.style .token.string{color:var(--theme-ui-colors-code-cssString,#e3116c);}.token.important{font-weight:400;}.token.bold{font-weight:700;}.token.italic{font-style:italic;}.token.entity{cursor:help;}.token.plain{color:var(--theme-ui-colors-code-text,#393A34);}.token-line{margin-left:-1rem;margin-right:-1rem;padding-right:1rem;}.token-line > span.token:empty::after{min-height:1em;display:inline-block;content:"";}.namespace{opacity:0.7;}.gatsby-highlight{font-size:1rem;background:var(--theme-ui-colors-code-bg,#f6f8fa);color:var(--theme-ui-colors-text,#2d3748);position:relative;-webkit-overflow-scrolling:touch;overflow:auto;margin-left:-1rem;margin-right:-1rem;margin-bottom:1rem;}.gatsby-highlight-code-line{background:var(--theme-ui-colors-code-lineHighlightBackground,#fbf0ea);margin-left:-8rem;margin-right:-8rem;padding-left:4rem;padding-right:8rem;border-left:0.25rem solid var(--theme-ui-colors-code-lineHighlightBorder,#f1beb6);display:block;}.gatsby-highlight pre::-webkit-scrollbar{width:0.5rem;height:0.5rem;}.gatsby-highlight > code[class*="language-"],.gatsby-highlight > pre[class*="language-"]{word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}*{box-sizing:inherit;}body{margin:0;padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;}a{-webkit-transition:all 0.3s ease-in-out;transition:all 0.3s ease-in-out;color:var(--theme-ui-colors-text,#2d3748);}p > code,li > code{background-color:var(--theme-ui-colors-code-bg,#f6f8fa);color:var(--theme-ui-colors-code-text,#393A34);padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;word-break:break-word;overflow-wrap:break-word;word-wrap:break-word;}.prism-code{font-size:1rem;padding:1rem;webkit-overflow-scrolling:touch;background-color:transparent;overflow:initial;float:left;min-width:100%;margin-bottom:0;-webkit-text-size-adjust:none;text-size-adjust:none;}.prism-code[data-linenumber="false"] .token-line{padding-left:1rem;}.line-number-style{display:inline-block;width:2rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;text-align:center;position:relative;}pre.language-{margin-top:0;}pre.language-noLineNumbers{margin-top:0;}pre[class*="language-"]:before{background-color:var(--theme-ui-colors-code-bgLanguage,white);border-radius:0 0 0.25rem 0.25rem;color:var(--theme-ui-colors-code-textLanguage,black);font-size:12px;-webkit-letter-spacing:0.025rem;-moz-letter-spacing:0.025rem;-ms-letter-spacing:0.025rem;letter-spacing:0.025rem;padding:0.1rem 0.5rem;position:absolute;left:1rem;text-align:right;text-transform:uppercase;top:0;}pre[class~='language-java']:before{content:'java';}pre[class~='language-shell']:before{content:'shell';}pre[class~='language-yaml']:before{content:'yaml';}.code-title{background:var(--theme-ui-colors-code-bg,#f6f8fa);border-bottom:1px solid var(--theme-ui-colors-code-border,#ececec);color:var(--theme-ui-colors-code-text,#393A34);padding:0.5rem 2rem 0.5rem;font-size:0.875rem;margin-left:-1rem;margin-right:-1rem;margin-top:0.5rem;border-top-left-radius:0.5rem;border-top-right-radius:0.5rem;font-family:monospace;}.code-title[data-linenumber="false"]{padding-left:1rem;}@media (min-width:768px){.gatsby-highlight,.code-title{margin-left:0;margin-right:0;}}#___gatsby .gatsby-resp-image-wrapper{box-shadow:none;}.highlight-line{background:var(--theme-ui-colors-code-lineHighlightBackground,#fbf0ea);border-left:4px solid var(--theme-ui-colors-code-lineHighlightBorder,#f1beb6);display:block;}.highlight-line .line-number-style{width:calc(2rem - 4px);opacity:0.5;left:-2px;}</style><style data-emotion-css="1g597hz">.css-1g597hz{border:0;-webkit-clip:react(0 0 0 0);clip:react(0 0 0 0);height:1px;width:1px;margin:-1px;padding:0;overflow:hidden;position:absolute;}.css-1g597hz:focus{padding:1rem;position:fixed;top:15px;left:15px;background-color:var(--theme-ui-colors-heading,#000);color:var(--theme-ui-colors-background,#fff);z-index:1;width:auto;height:auto;-webkit-clip:auto;clip:auto;-webkit-text-decoration:none;text-decoration:none;}</style><a href="#skip-nav" data-skip-link="true" class="css-1g597hz">Skip to content</a><style data-emotion-css="1jrqzhj">.css-1jrqzhj{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:container;margin-left:auto;margin-right:auto;padding:1rem;max-width:1024px;}@media screen and (min-width:640px){.css-1jrqzhj{padding:2rem;}}</style><div class="css-1jrqzhj"><style data-emotion-css="1wt4r56">.css-1wt4r56{margin-bottom:4rem;}@media screen and (min-width:640px){.css-1wt4r56{margin-bottom:8rem;}}</style><header class="css-1wt4r56"><style data-emotion-css="1eswzqe">.css-1eswzqe{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}</style><style data-emotion-css="190uhut">.css-190uhut{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}</style><div class="css-190uhut"><style data-emotion-css="dz3ojy">.css-dz3ojy{color:var(--theme-ui-colors-heading,#000);-webkit-text-decoration:none;text-decoration:none;}</style><a aria-label="fdk - Back to home" class="css-dz3ojy" href="/"><style data-emotion-css="1kmktz0">.css-1kmktz0{margin-top:0;margin-bottom:0;font-weight:500;font-size:1.5rem;}@media screen and (min-width:640px){.css-1kmktz0{font-size:1.875rem;}}</style><h1 class="css-1kmktz0">fdk</h1></a><style data-emotion-css="af3ja4">.css-af3ja4{opacity:0.65;position:relative;border-radius:5px;width:40px;height:25px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-transition:opacity 0.3s ease;transition:opacity 0.3s ease;border:none;outline:none;background:none;cursor:pointer;padding:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;}.css-af3ja4:hover,.css-af3ja4:focus{opacity:1;}</style><button type="button" aria-label="Activate Dark Mode" title="Activate Dark Mode" class="css-af3ja4"><style data-emotion-css="iiu7h7">.css-iiu7h7{position:relative;width:24px;height:24px;border-radius:50%;border:none;background-color:var(--theme-ui-colors-transparent,transparent);-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1);-webkit-transition:all 0.45s ease;transition:all 0.45s ease;overflow:hidden;box-shadow:inset 8px -8px 0px 0px var(--theme-ui-colors-toggleIcon,#2d3748);}.css-iiu7h7:before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;border:none;border-radius:50%;-webkit-transform:translate(0,0);-ms-transform:translate(0,0);transform:translate(0,0);opacity:1;-webkit-transition:-webkit-transform 0.45s ease;-webkit-transition:transform 0.45s ease;transition:transform 0.45s ease;}.css-iiu7h7:after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0 0 -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon,#2d3748),0 23px 0 var(--theme-ui-colors-toggleIcon,#2d3748),23px 0 0 var(--theme-ui-colors-toggleIcon,#2d3748),-23px 0 0 var(--theme-ui-colors-toggleIcon,#2d3748),15px 15px 0 var(--theme-ui-colors-toggleIcon,#2d3748),-15px 15px 0 var(--theme-ui-colors-toggleIcon,#2d3748),15px -15px 0 var(--theme-ui-colors-toggleIcon,#2d3748),-15px -15px 0 var(--theme-ui-colors-toggleIcon,#2d3748);-webkit-transform:scale(0);-ms-transform:scale(0);transform:scale(0);-webkit-transition:all 0.35s ease;transition:all 0.35s ease;}</style><div class="css-iiu7h7"></div></button></div><style data-emotion-css="1kvspmd">.css-1kvspmd{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:var(--theme-ui-colors-divide,#cbd5e0);padding-bottom:1rem;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin-top:1rem;color:var(--theme-ui-colors-secondary,#5f6c80);-webkit-flex-flow:wrap;-ms-flex-flow:wrap;flex-flow:wrap;}.css-1kvspmd a{color:var(--theme-ui-colors-secondary,#5f6c80);}.css-1kvspmd a:hover{color:var(--theme-ui-colors-heading,#000);}</style><div class="css-1kvspmd"><style data-emotion-css="nrb238">.css-nrb238{font-size:1rem;}.css-nrb238 a:not(:last-of-type){margin-right:1rem;}@media screen and (min-width:640px){.css-nrb238{font-size:18px;}}.css-nrb238 .active{color:var(--theme-ui-colors-heading,#000);}</style><nav class="css-nrb238"><style data-emotion-css="1pp8c9n">.css-1pp8c9n{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-primary,#6b46c1);-webkit-text-decoration:none;text-decoration:none;word-break:break-word;overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto;display:inline-block;padding-top:0.5rem;padding-bottom:0.5rem;margin-top:-0.5rem;margin-bottom:-0.5rem;position:relative;vertical-align:top;}.css-1pp8c9n:hover{-webkit-text-decoration:underline;text-decoration:underline;}@media screen and (min-width:640px){.css-1pp8c9n{padding-top:0.25rem;padding-bottom:0.25rem;margin-top:-0.25rem;margin-bottom:-0.25rem;}}@media screen and (min-width:768px){.css-1pp8c9n{padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;}}@media screen and (min-width:1024px){.css-1pp8c9n{padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;}}</style><a class="css-1pp8c9n" href="/blog/">Blog</a><a class="css-1pp8c9n" href="/about/">About</a></nav><style data-emotion-css="e5k4e3">.css-e5k4e3{font-size:1rem;}.css-e5k4e3 a:not(:first-of-type){margin-left:1rem;}@media screen and (min-width:640px){.css-e5k4e3{font-size:18px;}}</style><div class="css-e5k4e3"><a href="https://twitter.com/Frederiiiiik" class="css-1pp8c9n">Twitter</a></div></div></header><style data-emotion-css="vurnku">.css-vurnku{box-sizing:border-box;margin:0;min-width:0;}</style><div id="skip-nav" class="css-vurnku"><style data-emotion-css="19ykez0">.css-19ykez0{box-sizing:border-box;margin:0;min-width:0;font-family:inherit;font-weight:700;line-height:1.25;font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:2rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-19ykez0{font-size:2.25rem;}}@media screen and (min-width:768px){.css-19ykez0{font-size:3rem;}}</style><h2 class="css-19ykez0">Securing Kubernetes Apps with Keycloak and Gatekeeper</h2><style data-emotion-css="1fkzbc2">.css-1fkzbc2{color:var(--theme-ui-colors-secondary,#5f6c80);margin-top:1rem;font-size:1rem;}.css-1fkzbc2 a{color:var(--theme-ui-colors-secondary,#5f6c80);}@media screen and (min-width:640px){.css-1fkzbc2{font-size:1rem;}}@media screen and (min-width:768px){.css-1fkzbc2{font-size:1.25rem;}}</style><p class="css-1fkzbc2"><time>08.05.2020</time> — <style data-emotion-css="6lenlk">.css-6lenlk{color:var(--theme-ui-colors-primary,#6b46c1);-webkit-text-decoration:none;text-decoration:none;word-break:break-word;overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto;display:inline-block;padding-top:0.5rem;padding-bottom:0.5rem;margin-top:-0.5rem;margin-bottom:-0.5rem;position:relative;vertical-align:top;}.css-6lenlk:hover{-webkit-text-decoration:underline;text-decoration:underline;}@media screen and (min-width:640px){.css-6lenlk{padding-top:0.25rem;padding-bottom:0.25rem;margin-top:-0.25rem;margin-bottom:-0.25rem;}}@media screen and (min-width:768px){.css-6lenlk{padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;}}@media screen and (min-width:1024px){.css-6lenlk{padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;}}</style><a class="css-6lenlk" href="/tags/k-8-s/">k8s</a>, <a class="css-6lenlk" href="/tags/keycloak/">keycloak</a>, <a class="css-6lenlk" href="/tags/oidc/">oidc</a>, <a class="css-6lenlk" href="/tags/minikube/">minikube</a> — <span>4<!-- --> min read</span></p><style data-emotion-css="f0b8g7">.css-f0b8g7{margin-top:4rem;margin-bottom:4rem;}.css-f0b8g7 .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;box-shadow:rgba(0,0,0,0.15) 0px 32px 32px 0px,rgba(0,0,0,0.15) 0px 16px 16px 0px,rgba(0,0,0,0.15) 0px 8px 8px 0px,rgba(0,0,0,0.15) 0px 4px 4px 0px;}@media screen and (min-width:640px){.css-f0b8g7 .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;}}@media screen and (min-width:768px){.css-f0b8g7 .gatsby-resp-image-wrapper{margin-top:4rem;margin-bottom:4rem;}}</style><section class="css-f0b8g7"><style data-emotion-css="djx0ab">.css-djx0ab{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.7;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-djx0ab{font-size:1rem;}}@media screen and (min-width:768px){.css-djx0ab{font-size:1.25rem;}}</style><p class="css-djx0ab">Today there are many ways to secure applications. With the rise of Kubernetes you might search for a self hosted open source
solution for Identity Management. One of the most popular and powerful candidates is <a href="https://www.keycloak.org" class="css-6lenlk">Keycloak</a>.
Lets explore how these both work together.</p><p class="css-djx0ab">For my sample scenario I am going to use <a href="https://minikube.sigs.k8s.io/docs/" class="css-6lenlk">minikube</a> to setup a local Kubernetes cluster to work with.
My goal is to protect an application running in this cluster without the need of adding any code to it.
Additionally it should be a scaling solution that can be easily added to any other application running inside the cluster.
As sample application to protect, I chose <a href="http://httpbin.org" class="css-6lenlk">httpbin</a>.</p><style data-emotion-css="170hkfz">.css-170hkfz{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:2rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-170hkfz{font-size:1.875rem;}}@media screen and (min-width:768px){.css-170hkfz{font-size:2.25rem;}}</style><h3 class="css-170hkfz">Setting up Keycloak with persistence</h3><p class="css-djx0ab">At the very first I need a running keycloak instance to authenticate to.
Even though the <a href="https://github.com/keycloak/keycloak-operator" class="css-6lenlk">keycloak-operator</a> seems to be in a pretty early stage
and might not work perfectly yet, I decided to give it a try. Lets clone the git repo and checkout the latest release.</p><p class="css-djx0ab">In order to use the custom keycloak resource definitions coming from the operator, they need to be applied to the cluster.
There is a Makefile target that can be used for this. Along with CRDs it also deploys some roles, bindings, service accounts etc.
When these basic cluster preparations are done, the keycloak-operator can be deployed into the newly created keycloak namespace.</p><p class="css-djx0ab">Since I do not want to lose my configured keycloak data every time I restart my minikube kubernetes
cluster, I want to setup keycloak with persistence. Before proceeding with the installation of keycloak
it is necessary to setup a <code class="css-0">PersistentVolume</code>, that can be used for the underlying postgres database.</p><p class="css-djx0ab">Finally keycloak can be installed by using the <code class="css-0">keycloaks.keycloak.org</code> CRD. It is going to deploy a postgresql database
using our persistence volume, that then can get picked up by keycloak.</p><p class="css-djx0ab">Keycloak is running and ready to be used.
To setup an easy accessible address for the keycloak instance the minikube ingress addon together with a hostname entry can be used.
While I am at adding hostnames, I already add another one that I need for resolving my sample httpbin application later on.</p><p class="css-djx0ab">Of course the corresponding Kubernetes ingress resource needs to be created as well. This resource could also be created by the
keycloak operator by passing <code class="css-0">externalAccess.enabled: True</code> to the keycloak spec, but it did not work for me due to some missing annotation
for telling nginx to use https for the upstream service. So I created an ingress resource by myself.</p><p class="css-djx0ab">If everything is set up correctly, the keycloak instance should be accessible now.</p><h3 class="css-170hkfz">Configuring Keycloak for the client application</h3><p class="css-djx0ab">Now, after keycloak was successfully installed to the cluster, it is time to prepare the instance for
the client application. The easiest way might be to use the adminstration console UI from keycloak.
It can be accessed via browser at <code class="css-0">http://keycloak.local/auth/admin/</code>. The necessary admin credentials
have been initially created as kubernetes secrets by the keycloak operator while installing.</p><p class="css-djx0ab">Taking the credentials to login to the adminstration console UI, the client configuration can be started.
Following steps have to be done:</p><style data-emotion-css="1q6guni">.css-1q6guni li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.7;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-1q6guni li{font-size:1rem;}}@media screen and (min-width:768px){.css-1q6guni li{font-size:1.25rem;}}</style><ol class="css-1q6guni"><style data-emotion-css="19l9a8">.css-19l9a8{padding-top:0.5rem;padding-bottom:0.5rem;}@media screen and (min-width:640px){.css-19l9a8{padding-top:0.25rem;padding-bottom:0.25rem;}}@media screen and (min-width:768px){.css-19l9a8{padding-top:0;padding-bottom:0;}}@media screen and (min-width:1024px){.css-19l9a8{padding-top:0;padding-bottom:0;}}</style><li class="css-19l9a8">Create a new realm. To not run into trouble with login later on, since I have not set up proper certificates for tls, I am setting an insecure &quot;Frontend URL&quot; to
<code class="css-0">http://keycloak.local/auth</code> for this realm.</li><li class="css-19l9a8">Add a client with protocol <code class="css-0">openid-connect</code> and access type <code class="css-0">confidential</code>. Add <code class="css-0">http://httpbin.local/oauth/callback</code> to valid Redirect URIs.</li><li class="css-19l9a8">Goto to the &quot;Client Scopes&quot; menu and add a new client scope. Create new protocol with mapper type audience, select your client in &quot;Included Client Audience&quot;
and set &quot;Add to access token&quot; to &quot;On&quot;.</li><li class="css-19l9a8">In client settings go to client scopes and add your created client scope containing the audience mapper.</li><li class="css-19l9a8">Add a user and set a password in the &quot;Credentials&quot; tab.</li></ol><p class="css-djx0ab">I called my realm <code class="css-0">test</code> and my client <code class="css-0">httpbin</code>. By setting the client access-type to <code class="css-0">confidential</code> a client-secret has
been generated by keycloak. It is needed for the upcoming gatekeeper configuration and can be found at the credentials tab of
the client configuration.</p><h3 class="css-170hkfz">Deploying Client Application along with Keycloak Gatekeeper</h3><p class="css-djx0ab">By having a running keycloak instance configured with proper client settings and a test user, everything is in place
to protect the sample httbin application. As mentioned in the introduction I would like to secure the application
without adding code. Here comes <a href="https://github.com/keycloak/keycloak-gatekeeper" class="css-6lenlk">Keycloak Gatekeeper</a> into play, which
is an OIDC proxy service, handling authentication for an upstream application. The idea of gatekeeper is to have it as close
as possible to the upstream application, thats why I am going to deploy it as sidecar to the httpbin application.
But before proceeding with the deployment, the client-secret (from keycloak client configuration) needs to be accessible in the cluster.</p><p class="css-djx0ab">Having the secret in place, finally the sample application along with gatekeeper can be deployed.</p><p class="css-djx0ab">To make the OIDC discovery of gatekeeper work with the internal Keycloak Kubernetes service URL, it is necessary to pass it as argument
to the <code class="css-0">--openid-provider-proxy</code> parameter. I found a related issue <a href="https://github.com/keycloak/keycloak-gatekeeper/issues/539" class="css-6lenlk">here</a>.</p><h3 class="css-170hkfz">Is my Application protected now?</h3><p class="css-djx0ab">To verify the protection of my httpbin application, I am going to use a couple of curl commands.
First of all, what happens when I try to access my httpbin application?</p><p class="css-djx0ab">Cool, I get redirected to the keycloak login page. Lets use the credentials of the test-user I created earlier.
To use the received access token for further commands, I am storing it inside a shell variable by using the command-line
JSON processor <a href="https://stedolan.github.io/jq/" class="css-6lenlk"><code class="css-0">jq</code></a> for grabbing it from the JSON response.</p><p class="css-djx0ab">Et Voilà! After getting an access token for my test-user, I can finally pass through gatekeeper to my httpbin application, showing that I am authenticated.
Goal reached! :) For upstream services it might be necessary to get some user information as well. These can be obtained from custom headers forwarded
by gatekeeper.</p><p class="css-djx0ab">For having a better and more insightful reading experience I used curl here. Of course it is easier to verify the protection by navigate to
<code class="css-0">http://httpbin.local</code> in browser and go through the flow there.</p><h3 class="css-170hkfz">Conclusion</h3><p class="css-djx0ab">I think keycloak is a wonderful piece of software for handling user identity. It might be not the easiest to setup with Kubernetes yet,
but I am confident that especially the keycloak-operator will improve quick and constantly. Using gatekeeper deployed as sidecar to the application
you want to protect by providing a little configuration seems to me like a very scalable and consistent solution. At the time of
microservices you want to focus as much as possible on business logic. This solution could save you from implementing same authentication
layer over and over again. Additionally it can be applied to protect third-party applications, that do not support any auth flows by themselves,
like dashboards etc.</p><p class="css-djx0ab">Happy authenticating and authorizing!</p><style data-emotion-css="rrejfe">.css-rrejfe{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.25rem;color:var(--theme-ui-colors-heading,#000);margin-top:1rem;}@media screen and (min-width:640px){.css-rrejfe{font-size:1.5rem;}}@media screen and (min-width:768px){.css-rrejfe{font-size:1.875rem;}}</style><h4 class="css-rrejfe">References</h4><ul class="css-1q6guni"><li class="css-19l9a8"><a href="https://www.keycloak.org/getting-started/getting-started-kube" class="css-6lenlk">https://www.keycloak.org/getting-started/getting-started-kube</a></li><li class="css-19l9a8"><a href="https://github.com/keycloak/keycloak-operator" class="css-6lenlk">https://github.com/keycloak/keycloak-operator</a></li><li class="css-19l9a8"><a href="https://www.keycloak.org/docs/latest/securing_apps/#_keycloak_generic_adapter" class="css-6lenlk">https://www.keycloak.org/docs/latest/securing_apps/#_keycloak_generic_adapter</a></li><li class="css-19l9a8"><a href="https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/#backend-protocol" class="css-6lenlk">https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/#backend-protocol</a></li></ul></section></div><style data-emotion-css="6x8z6y">.css-6x8z6y{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin-top:8rem;color:var(--theme-ui-colors-secondary,#5f6c80);-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border-top-style:solid;border-top-width:1px;border-top-color:var(--theme-ui-colors-divide,#cbd5e0);padding-top:1rem;}.css-6x8z6y a{color:var(--theme-ui-colors-secondary,#5f6c80);-webkit-text-decoration:none;text-decoration:none;}.css-6x8z6y a:hover{color:var(--theme-ui-colors-heading,#000);-webkit-text-decoration:underline;text-decoration:underline;}.css-6x8z6y a:focus{color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-6x8z6y{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}@media screen and (min-width:768px){.css-6x8z6y{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}</style><footer class="css-6x8z6y"><div>© <!-- -->2020<!-- --> by <!-- -->fdk<!-- -->. All rights reserved.</div><div><a>Deactivate Google Analytics</a></div><div><a aria-label="Link to the theme&#x27;s GitHub repository" href="https://github.com/LekoArts/gatsby-themes/tree/master/themes/gatsby-theme-minimal-blog" class="css-1pp8c9n">Theme</a> <!-- -->by<!-- --> <a aria-label="Link to the theme author&#x27;s website" href="https://www.lekoarts.de/en" class="css-1pp8c9n">LekoArts</a></div></footer></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/securing-kubernetes-apps-with-keycloak-and-gatekeeper/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-0b013317c71a5f725542.js"],"app":["/app-a8c28beaf1507299f728.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-e5cb9e0c77a823b86dc2.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx-08f513d1a75e114e6f07.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx-0849b5024c1e3d7021da.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-1ed02939c4aac9155aae.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx-fe1bd3f4a50d631b4fe0.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx-5f5b3ff9366c1976f3d0.js"],"component---src-components-about-tsx":["/component---src-components-about-tsx-34b32db8a40cc67b068e.js"]};/*]]>*/</script><script src="/polyfill-0b013317c71a5f725542.js" nomodule=""></script><script src="/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-1ed02939c4aac9155aae.js" async=""></script><script src="/102afc7344577b55a38080236d2030dfabdf8510-02237cb284883f3ba59b.js" async=""></script><script src="/styles-c2fe8482057191dca484.js" async=""></script><script src="/app-a8c28beaf1507299f728.js" async=""></script><script src="/framework-0e8501c0599d79803b4b.js" async=""></script><script src="/webpack-runtime-eb4bd5f9f9bc8e21e756.js" async=""></script></body></html>